<!doctype html>



<html lang="zh-hk">
    <head>
        <title>報告失蹤人口 - 尋找 Private Ryan </title>
        <link rel="canonical" href="">
<meta charset="utf-8">
<meta name="theme-color" content="#563d7c">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<!-- ICON -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<!-- CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"  integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link href="/css/base.css" rel="stylesheet">
<!-- fonts -->
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<!-- JS -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!-- VUE.js libraries -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.5.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-moment@4.0.0"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js" integrity="sha256-VeNaFBVDhoX3H+gJ37DpT/nTuZTdjYro9yBruHjVmoQ=" crossorigin="anonymous"></script>
<!-- Firebase libraries -->
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-app.js"></script>
<!-- <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-analytics.js"></script> -->
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-storage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-firestore@0.3.22"></script>
<script>
// Your web app's Firebase configuration
var firebaseConfig = {
	apiKey: "AIzaSyCCck3qekiA_x8iZYU3FLWUVlHw-HA4oOU",
	authDomain: "findingprivateryan.firebaseapp.com",
	databaseURL: "https://findingprivateryan.firebaseio.com",
	projectId: "findingprivateryan",
	storageBucket: "findingprivateryan.appspot.com",
	messagingSenderId: "977622455120",
	appId: "1:977622455120:web:28a162a4d1bf21c064d255"
};
// Initialize Firebase
const firebaseApp = firebase.initializeApp(firebaseConfig);

</script>
        <style>
            .bd-placeholder-img {
                font-size: 1.125rem;
                text-anchor: middle;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
            @media (min-width: 768px) {
                .bd-placeholder-img-lg {
                    font-size: 3.5rem;
                }
            }
        </style>       
    </head>
    <body>
        <div class="container">
<header class="blog-header py-3">
	<div class="row flex-nowrap justify-content-between align-items-center">
		<div class="col-3 pt-1">
			<div class="d-md-none" style="background: url('/images/logo_s.png');width:56px;height:60px;background-position: center center;background-repeat: no-repeat;"></div>
		</div>
		<div class="d-md-none col-6 text-center">
			<a class="blog-header-logo text-dark" href="/">尋找 Private Ryan</a>
		</div>
		<div class="d-none d-md-block col-6 text-center" style="background: url('/images/logo.png');height:160px !important; background-position: center center;background-repeat: no-repeat; padding-left:160px;text-align:right !important;">
			<a class="blog-header-logo text-dark" href="/" style="position: relative; bottom: -50px">尋找 Private Ryan</a>
		</div>
		<div class="col-3 d-flex justify-content-end align-items-center">
			<!--
			<a class="text-muted" href="#" aria-label="Search">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="mx-3" role="img" viewBox="0 0 24 24" focusable="false"><title>Search</title><circle cx="10.5" cy="10.5" r="7.5"/><path d="M21 21l-5.2-5.2"/></svg>
			</a>
			<a class="btn btn-sm btn-outline-secondary" href="#">網站籌備中...</a>
			-->
		</div>
	</div>
</header>
<div class="nav-scroller py-1 mb-2">
	<nav class="nav d-flex justify-content-between">
		<a class="p-2 text-muted" href="/mission.html" >成立目的</a>
		<a class="p-2 text-muted" href="/missing.html" >失蹤人口</a>
		<a class="p-2 text-muted" href="/regulations.html" >認清法規</a>
		<a class="p-2 text-muted" href="/help.html" >尋求協助</a>
		<a class="p-2 text-muted" href="/hong-kong-family-online.html" >香港家人連線</a>
		<a class="p-2 text-muted" href="/news.html" >最新消息</a>
		<a class="p-2 text-muted" href="/review.html" >每月回顧</a>
		<a class="p-2 text-muted" href="/aboutus.html" >尋找我們</a>
		<a class="p-2 text-muted" style="color: #3b5998 !important" href="https://www.facebook.com/FindingPrivateRyan/">
			<i class="fa fa-facebook" aria-hidden="true"></i>
		</a>
		<a class="p-2 text-muted" style="color: #3f729b !important" href="">
			<i class="fa fa-instagram" aria-hidden="true"></i>
		</a>
	</nav>
</div>
        </div>
        <main role="main" class="container">
              <div id="fireApps">
  	<nav class="navbar navbar-expand-lg navbar-light bg-light">
  		<a class="navbar-brand mr-auto" href="#">報告失蹤人口</a>
  		<div v-if="user" class="my-2 my-lg-0">
  			<img :src="user.photoURL" alt="avatar" style="width: 30px; height: 30px; border-radius: 8%;"><button v-on:click="signOut" class="btn btn-outline-success my-2 my-sm-0">登出 %{user.email}</button>
  		</div>
  		<div v-else-if="!user && !loading">
			<button v-on:click="signInWithGithub" class="btn btn-outline-default my-2 my-sm-0">登入</button>
  		</div>
  	</nav>
  	<div v-if="user" class="container">
  		<br/>
  		<button v-on:click="exportWantedList" class="btn btn-info">匯出失蹤人口清單
</button>
		<form v-on:submit.prevent style="background-color:#e9ecef; padding: 1rem; margin-bottom: 1rem; border-radius: 0.5rem">
			<div class="form-row">
				<div class="form-group col-md-1">
					<label for="create_year">年</label>
					<select id="create_year" v-model.trim="m_year" class="form-control">
						<option selected value="-">不詳</option>
						<option value="2020">2020</option>
						<option value="2019">2019</option>
					</select>
				</div>
				<div class="form-group col-md-1">
					<label for="create_month">月</label>
					<select id="create_month" v-model.trim="m_month" class="form-control">
						<option selected value="-">不詳</option>
						<option value="01">01</option>
						<option value="02">02</option>
						<option value="03">03</option>
						<option value="04">04</option>
						<option value="05">05</option>
						<option value="06">06</option>
						<option value="07">07</option>
						<option value="08">08</option>
						<option value="09">09</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
					</select>
				</div>
				<div class="form-group col-md-1">
					<label for="create_day">日</label>
					<select id="create_day" v-model.trim="m_day" class="form-control">
						<option selected value="-">不詳</option>
						<option value="01">01</option>
						<option value="02">02</option>
						<option value="03">03</option>
						<option value="04">04</option>
						<option value="05">05</option>
						<option value="06">06</option>
						<option value="07">07</option>
						<option value="08">08</option>
						<option value="09">09</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
						<option value="15">15</option>
						<option value="16">16</option>
						<option value="17">17</option>
						<option value="18">18</option>
						<option value="19">19</option>
						<option value="20">20</option>
						<option value="21">21</option>
						<option value="22">22</option>
						<option value="23">23</option>
						<option value="24">24</option>
						<option value="25">25</option>
						<option value="26">26</option>
						<option value="27">27</option>
						<option value="28">28</option>
						<option value="29">29</option>
						<option value="30">30</option>
						<option value="31">31</option>
					</select>
				</div>
				<div class="form-group col-md-5">
					<label for="create_name">名字</label>
					<input id="create_name" v-model.trim="m_name" type="text" maxlength="50" class="form-control" placeholder="名字、暱稱" autocomplete="off">
				</div>
				<div class="form-group col-md-2">
					<label for="create_gender">姓別</label>
					<select id="create_gender" v-model.trim="m_gender" class="form-control">
						<option selected value="-">不詳</option>
						<option value="M">男</option>
						<option value="F">女</option>
					</select>
				</div>
				<div class="form-group col-md-2">
					<label for="create_age">年齡 (不詳 = 0) </label>
					<input id="create_age" v-model.trim="m_age" type="number" min="0" max="120" value="0" class="form-control">
				</div>
				<div class="form-group col-md-4">
					<label for="create_description">描述 (尚可入 %{200-this.m_description.length} 字)</label>
					<textarea id="create_description" v-model.trim="m_description" rows="3" maxlength="200" class="form-control" placeholder="任意描述，盡可能中立、精簡。" autocomplete="off"></textarea>
				</div>
				<div class="form-group col-md-4">
					<label for="create_contact">聯絡方法 (尚可入 %{200-this.m_contact.length} 字)</label>
					<textarea id="create_contact" v-model.trim="m_contact" rows="3" maxlength="200" class="form-control" placeholder="請先考慮聯繫資料是否合適, 最好先測試真確性." autocomplete="off"></textarea>
				</div>
				<div class="form-group col-md-4">
					<label for="create_tags">標籤 (尚可入 %{200-this.m_tags.length} 字)</label>
					<textarea id="create_tags" v-model.trim="m_tags" rows="3" maxlength="200" class="form-control" placeholder="請以 # 號開始, 如: #學生 #受傷" autocomplete="off"></textarea>
				</div>
				<div class="form-group col-md-4">
					<label for="create_source">來源</label>
					<input id="create_source" v-model.trim="m_source" type="text" maxlength="50" class="form-control" placeholder="XX關注組, XX TG, XX日報" autocomplete="off">
				</div>
				<div class="form-group col-md-8">
					<label for="create_source_url">來源網址</label>
					<input id="create_source_url" v-model.trim="m_source_url" type="text" maxlength="50" class="form-control" placeholder="https://www.domain.com/page/details.html" autocomplete="off">
				</div>
			</div>
			<div class="form-row">
				<button v-on:click="createWanted" class="btn btn-warning">登記</button>
			</div>
		</form>

		<div v-show="false" class="form-group custom-file">
			<label v-if="imageData == null" class="custom-file-label" for="create_image">上傳近照 </label>
			<label v-else class="custom-file-label" for="create_image">%{imageData.name}</label>
			<input id="create_image" type="file" v-on:change="uploadWantedImage" accept="image/*" class="fcustom-file-input" placeholder="JPG" autocomplete="off">
		</div>

  		<div class="row" v-for="item in wantedList" style="background-color:#fff9bd; padding: 1rem; margin-bottom: 1rem; border-radius: 0.5rem">
  			<div class="col-3 col-md-2">
				<div>
					<img v-if="item.image_src != null" class="img-fluid" :src="item.image_src">
					<svg v-else class="bd-placeholder-img" width="100" height="125" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect width="100%" height="100%" fill="#55595c"/><text x="50%" y="50%" fill="#eceeef" dy=".3em" font-size=".8em">100 x 125</text><text x="50%" y="74%" fill="#eceeef" dy=".3em" font-size=".8em">(&lt;200kb)</text></svg>
					<button v-if="item.image_src == null" v-on:click="selectImage(item)" class="btn btn-success">上傳照片</button>
					<button v-else v-on:click="deleteWantedImage(item)" class="btn btn-danger">刪除照片</button>
				</div>
  			</div>
  			<div class="col-9 col-md-10">
  				<div class="row">
		  			<div class="col-12">
		  				<h4 style="font-family: 'Georgia'">
		  					<span v-if="item.isFound" class="badge badge-success">己尋回</span>
		  					<span v-else class="badge badge-danger">失蹤</span>
				  			<span v-if="item.name == '-' || item.name == ''" class="">姓名不詳</span>
				  			<span v-else class="">%{item.name}</span>
				  			<span> / </span>
				  			<span v-if="item.gender == 'M'" class="">男</span>
				  			<span v-else-if="item.gender == 'F'" class="">女</span>
				  			<span v-else class="">性別不詳</span>
							<span> / </span>
				  			<span v-if="item.age == 0" class="">年齡不詳</span>
				  			<span v-else class="">%{item.age}</span>
			  			</h4>
		  			</div>
					<div class="col-12">
			  			<span v-if="item.year == '-' || item.year == ''" class=""> - 年</span>
			  			<span v-else class="">%{item.year} 年</span>
			  			<span v-if="item.month == '-' || item.month == ''" class=""> - 月</span>
			  			<span v-else class="">%{item.month} 月</span>
			  			<span v-if="item.day == '-' || item.day == ''" class=""> - 日</span>
			  			<span v-else class="">%{item.day} 日 </span>
			  		</div>
		  			<div class="col-md-12">描述：%{item.description}</div>
					<div class="col-md-12">聯絡方法：%{item.contact}</div>
					<div class="col-md-12">標籤：<span v-for="tag in item.tags" class="badge badge-info">%{tag}</span></div>
					<div class="col-md-4">來源：%{item.source}</div>
					<div class="col">來源網址：%{item.source_url}</div>
		  			<div class="col-auto">
		  				<button v-if="item.isFound" v-on:click="updateWantedStatus(item)" class="btn btn-outline-danger">失蹤</button>
			  			<button v-else v-on:click="updateWantedStatus(item)" class="btn btn-success">尋回</button>
			  			<button v-on:click="deleteWanted(item)" class="btn btn-danger">刪除</button>
			  		</div>
			  	</div>
		  	</div>
  		</div>
  	</div>
    <p v-if="loading">Loading...</p>

    <appmsg
    	eid="appMessageModal"
    	v-bind:title="this.modalTitle"
    	v-bind:message="this.modalMsg"
    >
    </appmsg>
  </div>

<script type="text/javascript">
	const db = firebaseApp.firestore()

	Vue.component('appmsg', {
		delimiters: ['%{', '}'],
		props: [ 'eid', 'title', "message" ],
		template: `
<div class="modal fade" :id="eid" tabindex="-1" role="dialog" :aria-labelledby="eid+'Title'" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" :id="eid + 'Title'">%{title}</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				%{message}
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>`
	})



	var app = new Vue({
		el: '#fireApps',
		beforeCreate: function() {
			firebase.auth().onAuthStateChanged((user) => {
				if (user) {
					this.user = user
				}
				this.loading = false
			})
		},
		data : {
			modalTitle: '',
			modalMsg: '',

			loading: true,
			user: null,
			items: [],
			item: '',
			m_year: '-',
			m_month: '-',
			m_day: '-',
			m_name: '',
			m_gender: '-',
			m_age: 0,
			m_description: '',
			m_contact: '',
			m_tags: '',
			m_source: '',
			m_source_url: '',

			uploadValue: 0,
			picture_url: null,
			imageData: null,
			imageRef: null,
			imageWanted: null,
		},
		firestore: function () {
			console.log('Firestore called');
			return { wantedList: db.collection('wanted') }
		},
		methods: {
			signInWithGithub: function() {
				const provider = new firebase.auth.GithubAuthProvider();
				firebase.auth().signInWithRedirect(provider).then((result) => {
					this.user = result.user
				}).catch(error => console.log(error))
			},
			signInWithGoogle: function() {
				const provider = new firebase.auth.GoogleAuthProvider()
				firebase.auth().signInWithRedirect(provider).then((result) => {
					this.user = result.user
				}).catch(error => console.log(error))
			},
			signOut: function() {
				firebase.auth().signOut().then(() => {
					this.user = null
				}).catch(error => console.log(error))
			},

			resetCreateForm: function(){
				this.m_year = '-';
				this.m_month =  '-';
				this.m_day =  '-';
				this.m_name = '';
				this.m_gender = '-';
				this.m_age = 0;
				this.m_description = '';
				this.m_contact = '';
				this.m_tags = '';
				this.m_source = '';
				this.m_source_url = '';

				this.uploadValue=0;
				this.picture_url=null;
				this.imageData = null;
				this.imageRef = null;
			},

			checkWanted: function() {
				app.modalMsg = '';
				let pass = true;
				this.m_name = this.m_name.trim();
				if ( this.m_name == '' ){
					this.m_name = "-";
				}

				this.m_source = this.m_source.trim();
				if ( this.m_source == '' ){
					this.m_source = "-";
				}

				this.m_source_url = this.m_source_url.trim();
				if ( this.m_source_url == '' ){
					this.m_source_url = "-";
				}

				let regHTML = new RegExp('<\/?[a-z][\s\S]*>');

				if (regHTML.test(this.m_description)){
					app.modalMsg = '描述中不要包含 HTML。\n';
					pass = false;
				}

				if (regHTML.test(this.m_contact)){
					app.modalMsg = '聯絡方法中不要包含 HTML。\n';
					pass = false;
				}

				if (regHTML.test(this.m_tags)){
					app.modalMsg = '標籤中不要包含 HTML。\n';
					pass = false;
				} 
				return pass;
			},

			convertTags: function(value){
				try {
					let tags = [];
					value = value.split("#")
					if (Array.isArray(value)){
						
						_.forEach(value, function(v){
							if ( v != '' && v != null ){
								tags = _.concat( tags, ["#"+v.trim()])
							}
						})
					}
					return tags;
				} catch (error){
					console.log(error);
				}
				return null;
			},

			createWanted: function(){

				if (!this.checkWanted()){
					app.modalTitle = '登記';
					app.modalMsg = "登記資料有誤！" + app.modalMsg;
					$('#appMessageModal').modal();
					return;
				}

				this.$firestore.wantedList.add({ 
					"isFound": false, "gender": this.m_gender, "age": this.m_age, "name": this.m_name, "year": this.m_year, "month": this.m_month, "day": this.m_day, "description": this.m_description, "contact": this.m_contact, "tags": 				this.convertTags(this.m_tags), "source": this.m_source, "source_url": this.m_source_url, "image_src": null, "created_by": this.user.uid, "created_at": firebase.firestore.FieldValue.serverTimestamp(), "updated_at": firebase.firestore.FieldValue.serverTimestamp(), iv: 'FPR-WEB-V0.1'
				}).then( function(){
					app.modalTitle = '登記';
					app.modalMsg = "成功登記";
					$('#appMessageModal').modal();
					app.resetCreateForm();
				}).catch ( function(error) {
					app.modalTitle = '登記';
					app.modalMsg = "登記失敗，" + error;
					$('#appMessageModal').modal();
				});
				
			},
			updateWanted: function(wanted){
				wanted.updated_by = this.user.uid;
				wanted.updated_at = firebase.firestore.FieldValue.serverTimestamp();
				this.$firestore.wantedList.doc(wanted['.key']).update(
					_.omit(wanted,'.key')
				).then( function(){
					app.modalTitle = '更新登記';
					app.modalMsg = "成功更新登記";
					$('#appMessageModal').modal();
					app.resetCreateForm();
				}).catch ( function(error) {
					app.modalTitle = '更新登記';
					app.modalMsg = "更新失敗，" + error;
					$('#appMessageModal').modal();
				});
			},
			updateWantedStatus: function(wanted){
				wanted.updated_by = this.user.uid;
				wanted.updated_at = firebase.firestore.FieldValue.serverTimestamp();
				wanted.isFound = !wanted.isFound;
				this.$firestore.wantedList.doc(wanted['.key']).update(
					_.omit(wanted,'.key')
				).then( function(){
					app.modalTitle = '更新登記';
					app.modalMsg = "成功更新登記";
					$('#appMessageModal').modal();
					app.resetCreateForm();
				}).catch ( function(error) {
					app.modalTitle = '更新登記';
					app.modalMsg = "更新失敗，" + error;
					$('#appMessageModal').modal();
				});
			},
			deleteWanted: function(wanted){
				wanted.deleted_by = this.user.uid;
				wanted.deleted_at = firebase.firestore.FieldValue.serverTimestamp();
				db.collection('deletedWanted').add(wanted);
			    this.$firestore.wantedList.doc(wanted['.key']).delete()
			    .then( function(){
					app.modalTitle = '刪除登記';
					app.modalMsg = "成功刪除登記";
					$('#appMessageModal').modal();
					app.resetCreateForm();
				}).catch ( function(error) {
					app.modalTitle = '刪除登記';
					app.modalMsg = "刪除失敗，" + error;
					$('#appMessageModal').modal();
				});
			},

			selectImage: function (wanted){
				this.imageWanted = wanted;
				$("#create_image").click();
			},

			uploadWantedImage: function(){
				if (event.target.files[0].size > 204800 ){
					this.modalTitle = '上傳圖片';
					this.modalMsg = "圖片檔案過大，只接受 200kb 以下圖片。檔案 "+event.target.files[0].name+" 大小：" + Math.round(event.target.files[0].size / 1024.0 ) + 'kb';

					$('#appMessageModal').modal();
					return;
				} 

				let wanted = this.imageWanted;
				this.uploadValue=0;
				this.picture_url=null;
				this.imageData = event.target.files[0];

				
				const storageRef=firebase.storage().ref('wanted/'+wanted['.key']).put(this.imageData);
				storageRef.on(`state_changed`, 
					snapshot => {
						this.uploadValue = (snapshot.bytesTransferred/snapshot.totalBytes)*100;
					}, 
					error => {
						console.log(error.message)
					},
					() => {	
						this.uploadValue=100;
						storageRef.snapshot.ref.getDownloadURL().then(
							(url) => {
								this.picture_url =url;
								wanted.image_src = url;
								console.log(' updateWanted (image changed) ' + wanted['.key'])
								this.updateWanted(wanted);

								this.uploadValue=0;
								this.picture_url=null;
								this.imageData = null;
								this.imageRef = null;
								this.imageWanted = null;
							}
						);
						this.imageRef = storageRef.snapshot.ref;
					}
					
				);
			},

			deleteWantedImage: function(wanted){
				const storageRef = firebase.storage().ref(wanted['.key']).delete();
				wanted.image_src = null;
				this.updateWanted(wanted);
				this.deleteImage();
			},

			deleteImage: function (){
				this.uploadValue=0;
				this.picture_url=null;
				this.imageData = null;
				this.imageRef = null;
			},

			exportWantedList: function (){
				try { 
				    const data = JSON.stringify(this.wantedList)
				    const blob = new Blob([data], {type: 'text/plain'})
				    const e = document.createEvent('MouseEvents'),
				    a = document.createElement('a');
				    a.download = "wantedList.json";
				    a.href = window.URL.createObjectURL(blob);
				    a.dataset.downloadurl = ['text/json', a.download, a.href].join(':');
				    e.initEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
				    a.dispatchEvent(e);

					this.modalTitle = '匯出';
					this.modalMsg = "匯出成功!" ;
					$('#appMessageModal').modal();

			    } catch (error) {
					this.modalTitle = '匯出';
					this.modalMsg = "匯出失敗! " + error ;
					$('#appMessageModal').modal();
				}
			}
		},
		delimiters: ['%{', '}']
	});

	$("form").on('submit',function(e){
		e.preventDefault();
	});
</script>
        </main><!-- /.container -->
        <!-- 
<footer class="blog-footer">
	<p>五大訴求 缺一不可</p>
</footer>
-->
    </body>
</html>